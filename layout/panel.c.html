<template name="panel_user">
{{#if currentUser}}
  登入身份：{{currentUser.profile.nick}}
  <a href="javascript:;" title="登出" class="text-warning logout"><i class="fa fa-sign-out"></i></a>
{{else}}
  <span class="label label-warning">登入身份：訪客</span>
  <a href="javascript:;" title="登入" class="text-success login"><i class="fa fa-sign-in"></i></a>
{{/if}}
</template>

<template name="panel_links">
  <a class="brand" href="/">TRPG Master 3.0</a>
  {{#if this.explain}}
  {{/if}}
  {{#if this.room}}
    <div>
      <i class="fa fa-chevron-right"></i>
      <a class="brand" href="/{{this.room._id}}">{{this.room.name}}</a>
      {{#if this.character}}
        <div>
          <i class="fa fa-chevron-right"></i>
          <a class="brand" href="/{{this.room._id}}/character/{{this.character._id}}">{{this.character.name}}</a>
        </div>
      {{/if}}
      {{#if this.chapter}}
        <div>
          <i class="fa fa-chevron-right"></i>
          <a class="brand" href="/{{this.room._id}}/chapter/{{this.chapter._id}}">{{this.chapter.name}}</a>
          {{#if this.map}}
            <div>
              <i class="fa fa-chevron-right"></i>
              <a class="brand" href="/{{this.room._id}}/chapter/{{this.chapter._id}}/{{this.section._id}}/{{this.map._id}}">{{this.map.name}}</a>
            </div>
          {{/if}}
        </div>
      {{/if}}
    </div>
  {{/if}}
</template>

<template name="panel_accordion">
  <div class="panel-group">
    {{#if this.room}}
      {{#if this.map}}
        {{> panel_accordion_map}}
      {{else}}
        {{> panel_accordion_room}}
      {{/if}}
    {{else}}
      {{> panel_accordion_base}}
    {{/if}}
  </div>
</template>

<template name="panel_accordion_base">
  <div class="panel panel-default">
    <div class="panel-heading" role="tab" aria-expanded="false">
      <h4 class="panel-title">
        網站說明
      </h4>
    </div>
    <div class="panel-collapse collapse" role="tabpanel">
      <div class="panel-body">
        <ul class="nav nav-pills nav-stacked">
          <li>
            <a href="/explain/1">基本使用</a>
          </li>
          <li>
            <a href="/explain/2">遊戲紀錄</a>
          </li>
          <li>
            <a href="/explain/3">地圖系統</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
  {{#if currentUser}}
    <div class="panel panel-default">
      <div class="panel-heading" role="tab">
        <h4 class="panel-title" aria-expanded="false">
          <a href="javascript:;">
            我參與的故事
          </a>
        </h4>
      </div>
      <div class="panel-collapse collapse" role="tabpanel">
        <div class="panel-body">
          <ul class="nav nav-pills nav-stacked">
            {{#each myRoom}}
              <li>
                <a href="/room/{{this._id}}">{{this.name}}</a>
              </li>
            {{/each}}
          </ul>
        </div>
      </div>
    </div>
  {{/if}}
  <div class="panel panel-default">
    <div class="panel-heading" role="tab">
      <h4 class="panel-title">
        <a href="javascript:;" aria-expanded="false">
          進行中的故事
        </a>
      </h4>
    </div>
    <div class="panel-collapse collapse" role="tabpanel">
      <div class="panel-body">
          <ul class="nav nav-pills nav-stacked">
            {{#each nowRoom}}
              <li>
                <a href="/room/{{this._id}}">{{this.name}}</a>
              </li>
            {{/each}}
          </ul>
      </div>
    </div>
  </div>
  <div class="panel panel-default">
    <div class="panel-heading" role="tab">
      <h4 class="panel-title">
        <a href="javascript:;" aria-expanded="false">
          已完結的故事
        </a>
      </h4>
    </div>
    <div class="panel-collapse collapse" role="tabpanel">
      <div class="panel-body">
          <ul class="nav nav-pills nav-stacked">
            {{#each oldRoom}}
              <li>
                <a href="/room/{{this._id._str}}">{{this.name}}</a>
              </li>
            {{/each}}
          </ul>
      </div>
    </div>
  </div>
</template>

<template name="panel_accordion_map">
</template>